
<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Comments &#8212; Geographika</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css?v=9afac83c" />
    <link rel="stylesheet" type="text/css" href="../../_static/font-awesome-4.7.0/css/font-awesome.min.css?v=02f538dc" />
    <link rel="stylesheet" type="text/css" href="../../_static/mastodon-timeline.min.css?v=eddf9f32" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom-bootstrap-sphinx.css?v=459f6afa" />
    <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/ol.js?v=98716c8e"></script>
    <script src="../../_static/mastodon-timeline.js?v=47eed501"></script>
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>

  </head><body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          Geographika</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../software.html">Software</a></li>
                <li><a href="../../talks.html">Talks</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../software.html">Software Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../talks.html">Talks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../posts/index.html">Posts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Archived Posts</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">  
    <div class="body col-md-12 content" role="main">
      
  <hr><section id="comments">
<h1>Comments<a class="headerlink" href="#comments" title="Link to this heading">¶</a></h1>
<img alt="http://www.gravatar.com/avatar/2cd61240eb6c9a03794659f97cbf8811?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-291" src="http://www.gravatar.com/avatar/2cd61240eb6c9a03794659f97cbf8811?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-291"><span class="std std-ref">2.</span></a> <strong>Phillip</strong>
**</p>
<p>Hi there,</p>
<p>While I’ll be posting some details on the PyISAPIe list later regarding
changes in the new version to make this process easier, I just thought
I’d mention a few things that could help you in the future-</p>
<ul class="simple">
<li><p>PYI_PY_VERSION can be defined in the project settings, under
C++/Preprocessor. This is the easiest way to compile for different
versions because no source changes are required.</p></li>
<li><p>You can add additional include and library directories at the project
settings level rather than the Visual Studio settings level, which can
help in some cases.</p></li>
<li><p>If SubWCRev wasn’t working from Visual Studio but was from the command
line, all I can suggest is to log out and back into your Windows account
to be sure that your PATH has been updated everywhere (it works in
Windows 7 right after installing TortoiseSVN).</p></li>
</ul>
<p>Thank you for this guide, I’m positive that it will be a great help to
those compiling the project themselves.</p>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#2@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><img alt="http://www.gravatar.com/avatar/ec399a4765f732e1a2acd5ca7edd0fd5?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-296" src="http://www.gravatar.com/avatar/ec399a4765f732e1a2acd5ca7edd0fd5?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-296"><span class="std std-ref">3.</span></a> <strong>geographika</strong>
**</p>
<div class="line-block">
<div class="line"><a class="reference external" href="#comment-291">&#64;Phillip</a></div>
<div class="line-block">
<div class="line">Thanks for the tips. I’ve updated the post to include these, and went</div>
<div class="line">through the steps with the latest sourcecode.</div>
<div class="line">I should have realised the PATH had not been updated having wrote</div>
<div class="line">about it last week…!</div>
<div class="line">All is working well, and the new project set up makes it easy to</div>
<div class="line">compile for 32 bit or 64 bit, with many different Python versions.</div>
</div>
</div>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#3@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><img alt="http://www.gravatar.com/avatar/52a7495eeb9152acb2a39c9f0e83cfd9?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-308" src="http://www.gravatar.com/avatar/52a7495eeb9152acb2a39c9f0e83cfd9?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-308"><span class="std std-ref">4.</span></a> <strong>Jonathan Mayer</strong>
**</p>
<p>Fantastic work ( you’re on my favourites list!!)</p>
<p>You don’t happen to have a copy of the dll do you,</p>
<p>Cheers Jonathan ;-)</p>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#4@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><img alt="http://www.gravatar.com/avatar/ec399a4765f732e1a2acd5ca7edd0fd5?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-309" src="http://www.gravatar.com/avatar/ec399a4765f732e1a2acd5ca7edd0fd5?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-309"><span class="std std-ref">5.</span></a> <strong>geographika</strong>
**</p>
<div class="line-block">
<div class="line">Thanks Jonathan.</div>
<div class="line-block">
<div class="line">You can get a copy of the 64 bit DLL for Python 2.5 at</div>
<div class="line"><a class="reference external" href="http://geographika.co.uk/downloads/PyISAPIe64_Python25.zip">http://geographika.co.uk/downloads/PyISAPIe64_Python25.zip</a>.</div>
</div>
</div>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#5@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><img alt="http://www.gravatar.com/avatar/aee6b898db6192564421a2269f2afca1?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-465" src="http://www.gravatar.com/avatar/aee6b898db6192564421a2269f2afca1?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-465"><span class="std std-ref">6.</span></a> <strong>chris</strong>
**</p>
<div class="line-block">
<div class="line">Great work and an excellent tutorial!</div>
<div class="line-block">
<div class="line">I’m struggling, getting mod_python/mod_wsgi to work under Apache</div>
</div>
</div>
<p>2.2 compiled for 64-bit Windows for a while… After reading this, I
definitely will give IIS7+PyISAPIe a try.
|  Thanks!</p>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#6@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><img alt="http://www.gravatar.com/avatar/ec399a4765f732e1a2acd5ca7edd0fd5?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-466" src="http://www.gravatar.com/avatar/ec399a4765f732e1a2acd5ca7edd0fd5?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-466"><span class="std std-ref">7.</span></a> <strong>geographika</strong>
**</p>
<p>It has also been announced recently that development on mod_python is
to be abandoned
<a class="reference external" href="http://blog.dscpl.com.au/2010/06/modpython-project-is-now-officially.html">http://blog.dscpl.com.au/2010/06/modpython-project-is-now-officially.html</a>
so bail out now!</p>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#7@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><img alt="http://www.gravatar.com/avatar/4680c3e4cd9ba3197f16833edf0fa7e0?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-669" src="http://www.gravatar.com/avatar/4680c3e4cd9ba3197f16833edf0fa7e0?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-669"><span class="std std-ref">8.</span></a> <strong>James Crowley</strong>
**</p>
<p>This is an awesome article, thank you!!</p>
<p>I’ve successfully compiled this project to 64bit against Python 2.7.
However, when I set up the ISAPI filter in IIS I keep getting a</p>
<p>The specified module could not be found. (0x8007007e)</p>
<p>error. As far as I can tell, IIS has full access to that file (I’ve gone
as far as giving the Users group and IUSR and Network Service full
read/write access). Is there anything else likely to be going on here?
Not sure if there might be issues loading the python bindings or
something? Any ideas would be much appreciated!</p>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#8@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><img alt="http://www.gravatar.com/avatar/ec399a4765f732e1a2acd5ca7edd0fd5?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-670" src="http://www.gravatar.com/avatar/ec399a4765f732e1a2acd5ca7edd0fd5?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-670"><span class="std std-ref">9.</span></a> <strong>geographika</strong>
**</p>
<p>Hi James,</p>
<div class="line-block">
<div class="line">Take a look at <a class="reference external" href="http://geographika.co.uk/setting-up-python-on-iis7">http://geographika.co.uk/setting-up-python-on-iis7</a></div>
</div>
<p>which goes through the set up steps in IIS7. Previous versions should be
similar.
|  If you just installed Python on the server then try a reboot to make
sure the Python environment variables have been set.</p>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#9@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><img alt="http://www.gravatar.com/avatar/4680c3e4cd9ba3197f16833edf0fa7e0?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-671" src="http://www.gravatar.com/avatar/4680c3e4cd9ba3197f16833edf0fa7e0?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-671"><span class="std std-ref">10.</span></a> <strong>James Crowley</strong>
**</p>
<p>Seth, I’ve followed all those steps as far as I can see (I’m using IIS
7), and the server has been rebooted. Is there any way I can check that
the PyISAPIe library works without hooking in IIS? Thanks so much for
this :)</p>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#10@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><img alt="http://www.gravatar.com/avatar/ec399a4765f732e1a2acd5ca7edd0fd5?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-672" src="http://www.gravatar.com/avatar/ec399a4765f732e1a2acd5ca7edd0fd5?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-672"><span class="std std-ref">11.</span></a> <strong>geographika</strong>
**</p>
<p>As far as I know there is no wat to check outside of IIS. Does the
hello.py script produce the “module” error/</p>
<p>What I have found useful when getting errors is to use <a class="reference external" href="http://technet.microsoft.com/en-ie/sysinternals/bb896645(en-us).aspx">Process
Monitor</a>
to see what DLLs Windows is looking for, and any errors if it can’t find
them or if it does not have the correct security settings.</p>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#11@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><img alt="http://www.gravatar.com/avatar/4680c3e4cd9ba3197f16833edf0fa7e0?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-673" src="http://www.gravatar.com/avatar/4680c3e4cd9ba3197f16833edf0fa7e0?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-673"><span class="std std-ref">12.</span></a> <strong>James Crowley</strong>
**</p>
<p>Thanks! Yeah, its the hello.py script producing the module error. Will
try process monitor and see if that reveals anything.</p>
<p>BTW, as a sense check, downloaded your x64 bit version and the 2.5.4 amd
build you linked - this “works”, although complains about a ctypes
module not being present in python. I checked and it seems to be there
in 2.7 builds but not the 2.5.4 for some reason?</p>
<p>have joined the pyisapie email list now so will try and stop bugging you
now! :)</p>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#12@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><img alt="http://www.gravatar.com/avatar/?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-777" src="http://www.gravatar.com/avatar/?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-777"><span class="std std-ref">13.</span></a> <strong>MapFish Print Module for IIS at geographika</strong>
**</p>
<p>[…] Install and configure PyISAPIe. You can follow the instructions
described on this post or in the README file included with PyISAPIe . If
you want to run a 64 bit version, have a look at this post. […]</p>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#13@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><img alt="http://www.gravatar.com/avatar/1e7eaf045548b6914c5784c18cc89f09?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-871" src="http://www.gravatar.com/avatar/1e7eaf045548b6914c5784c18cc89f09?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-871"><span class="std std-ref">14.</span></a> <strong>Quaspam</strong>
**</p>
<div class="line-block">
<div class="line">Hi thanks for the great article, i have a very stupid question if i</div>
</div>
<p>may say, i followed about every step you mentioned and i am stuck when
the build gets to the linking stage, it gave the following error:
|  <strong>Error LNK1104: cannot open file ‘python27.lib’</strong>
|  here is my build command line:</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a>/OUT:”x64ReleasePyISAPIe.dll” /INCREMENTAL:NO /NOLOGO /LIBPATH:”C:pyisapiePythonx64Python27libs” /LIBPATH:”C:pyisapiePythonx64Python26libs” /LIBPATH:”C:pyisapiePythonx64Python25libs” /DLL “kernel32.lib” “user32.lib” “gdi32.lib” “winspool.lib” “comdlg32.lib” “advapi32.lib” “shell32.lib” “ole32.lib” “oleaut32.lib” “uuid.lib” “odbc32.lib” “odbccp32.lib” /NODEFAULTLIB:”libc libcmt msvcrt” /DEF:”PyISAPIe.def” /MANIFEST /ManifestFile:”x64ReleasePyISAPIe.dll.intermediate.manifest” /ALLOWISOLATION /MANIFESTUAC:”level=’asInvoker’ uiAccess=’false’” /PDB:”C:pyisapiex64ReleasePyISAPIe.pdb” /SUBSYSTEM:WINDOWS /OPT:REF /OPT:ICF /PGD:”C:pyisapiex64ReleasePyISAPIe.pgd” /LTCG /TLBID:1 /DYNAMICBASE:NO /IMPLIB:”x64ReleasePyISAPIe.lib” /MACHINE:X64 /ERRORREPORT:QUEUE ``</p>
<p>I am using VS2010 and i checked if python27.lib is accessible and
everything seems fine. Can you please help me</p>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#14@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><img alt="http://www.gravatar.com/avatar/ec399a4765f732e1a2acd5ca7edd0fd5?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-872" src="http://www.gravatar.com/avatar/ec399a4765f732e1a2acd5ca7edd0fd5?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-872"><span class="std std-ref">15.</span></a> <strong>geographika</strong>
**</p>
<p>Hi - it has been a while since I did this. I’ve not tried with 2.7, but
you probably have to add:</p>
<p><a href="#id3"><span class="problematic" id="id4">``</span></a>#elif PYI_PY_VERSION &gt;= PY_27   #define PYI_PY_VERSION_MAJOR PY_27   #include    #include    #include ``</p>
<p>My build outout for Python 2.6 (in VS2010) is:</p>
<p><a href="#id5"><span class="problematic" id="id6">``</span></a>/OUT:”x64ReleasePyISAPIe.dll” /INCREMENTAL:NO /NOLOGO /LIBPATH:”D:ProjectsPyISAPIePyISAPIePythonx64Python26libs” /LIBPATH:”D:ProjectsPyISAPIePyISAPIePythonx64Python25libs” /DLL “kernel32.lib” “user32.lib” “gdi32.lib” “winspool.lib” “comdlg32.lib” “advapi32.lib” “shell32.lib” “ole32.lib” “oleaut32.lib” “uuid.lib” “odbc32.lib” “odbccp32.lib” /NODEFAULTLIB:”libc libcmt msvcrt” /DEF:”PyISAPIe.def” /MANIFEST /ManifestFile:”x64ReleasePyISAPIe.dll.intermediate.manifest” /ALLOWISOLATION /MANIFESTUAC:”level=’asInvoker’ uiAccess=’false’” /PDB:”D:ProjectsPyISAPIePyISAPIex64ReleasePyISAPIe.pdb” /SUBSYSTEM:WINDOWS /OPT:REF /OPT:ICF /PGD:”D:ProjectsPyISAPIePyISAPIex64ReleasePyISAPIe.pgd” /LTCG /TLBID:1 /DYNAMICBASE:NO /IMPLIB:”x64ReleasePyISAPIe.lib” /MACHINE:X64 /ERRORREPORT:QUEUE ``</p>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#15@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><img alt="http://www.gravatar.com/avatar/?s=55&amp;d=identicon&amp;r=g" class="align-left" id="comment-1714" src="http://www.gravatar.com/avatar/?s=55&amp;d=identicon&amp;r=g" />
<p><a class="reference internal" href="../copying-spatial-data-between-sql-server-databases.html#comment-1714"><span class="std std-ref">16.</span></a> <strong>wolf++ &amp;raquo; Running Django on Windows: Python 2.7.2 x64, PyISAPIe and IIS 7.5</strong>
**</p>
<p>[…] not a compiled version of this available for Python 2.7 (x64 in my
case). geographika has a great post on doing this. The following
instructions are based on his guide, updated with newer versions. […]</p>
<a href="mailto:web+compiling-a-64-bit-version-of-pyisapie#16@geographika.co.uk?Subject=compiling-a-64-bit-version-of-pyisapie" target="_top">Reply</a><hr><a style="font-size: large; font-weight: bold;" href="mailto:web+copying-spatial-data-between-sql-server-databases@geographika.co.uk?Subject=copying-spatial-data-between-sql-server-databases" target="_top">Add Comment</a></section>


    </div>
      
  </div>
</div>
<script data-goatcounter="https://geographika.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2024.<br/>
    </p>
  </div>
</footer>

  </body>
</html>